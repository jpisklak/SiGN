---
output: github_document
bibliography: vignettes/bibTeX/refs.bib
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# SiGN

<!-- badges: start -->
<!-- badges: end -->

## Overview

SiGN is an R package that implements the Signals for Good News (SiGN) model to compute behavioural predictions in common operant choice paradigms.

## Installation

You can install the development version of SiGN from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("jpisklak/SiGN")
```

## Usage

```{r message = FALSE}
library(SiGN)

# Load built-in profile and customize parameters
tl_durs <- seq(1, 100, by = 0.01)

kendall <- choice_params("kendall",
  tl_dur_a1 = tl_durs, tl_dur_a2 = tl_durs,
  tl_dur_b1 = tl_durs, tl_dur_b2 = tl_durs
)

zentall <- choice_params("zentall",
  tl_dur_a1 = tl_durs, tl_dur_a2 = tl_durs,
  tl_dur_b1 = tl_durs, tl_dur_b2 = tl_durs
)

# Generate predictions
kendall_pred <- SiGN(kendall)
zentall_pred <- SiGN(zentall)
```

```{r fig.width = 6, fig.height = 4.5, dpi = 300, fig.align = 'center', out.width = '80%', echo = FALSE}
# Plot predictions
plot(tl_durs, kendall_pred$cp,
  type = "n", las = 1,
  xlim = c(0, 100), ylim = c(0, 1),
  xaxt = "n",
  xlab = "Duration of Terminal Links in Seconds (x)",
  ylab = "Predicted Choice Proportion"
)

axis(1, at = c(1, seq(20, 100, 20)))

abline(h = 0.5, lwd = 1, lty = 3, col = "grey")

lines(tl_durs, kendall_pred$cp,
  lwd = 2.5, lty = 1,
  col = palette.colors(palette = "Dark 2")[1]
)
lines(tl_durs, zentall_pred$cp,
  lwd = 2.5, lty = 2,
  col = palette.colors(palette = "Dark 2")[2]
)

legend("bottomright",
  legend = c("Kendall (1985)", "Stagner & Zentall (2010)"),
  lwd = c(2.5),
  lty = c(1, 2),
  col = palette.colors(palette = "Dark 2")[1:2],
  bty = "n"
)
```

## Available Data and Profiles

The package includes:
- Built-in parameter profiles (e.g., `"zentall"`, `"kendall"`, `"fantino"`) for @Stagner_Zentall_2010; @Kendall_1985; and @Fantino_1969 respectively.
- Data sets `subopt_avian` and `subopt_full`, compiled from @Dunn_et_al_2024.

## References
