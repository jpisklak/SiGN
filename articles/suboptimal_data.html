<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reproducing the Dunn et al. (2024) Analysis • SiGN</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reproducing the Dunn et al. (2024) Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SiGN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SiGN.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/squires_fantino.html">Revisiting Some Classic Studies</a></li>
    <li><a class="dropdown-item" href="../articles/suboptimal_data.html">Reproducing the Dunn et al. (2024) Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jpisklak.shinyapps.io/SiGN_Calc/">Online Calculator</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jpisklak/SiGN/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Reproducing the Dunn et al. (2024) Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jpisklak/SiGN/blob/master/vignettes/articles/suboptimal_data.Rmd" class="external-link"><code>vignettes/articles/suboptimal_data.Rmd</code></a></small>
      <div class="d-none name"><code>suboptimal_data.Rmd</code></div>
    </div>

    
    
<p>Dunn et al. (2024) compiled an exhaustive collection of studies
examining <em>suboptimal choice</em>. This dataset is included in the
SiGN package.</p>
<p>The complete, unfiltered data set is available via
<code>subopt_full</code>. For model evaluation, however, Dunn et
al. (2024) focused on a curated subset of studies involving pigeons and
starlings—species that, particularly in the case of pigeons, were the
most extensively studied and yielded the most robust and consistently
replicated findings. This filtered data set is provided in the SiGN
package as <code>subopt_avian</code>.</p>
<p>Each row in <code>subopt_avian</code> represents a distinct study
condition. Many of its columns, specifically 9 through 24, directly
correspond to parameters used by the <code><a href="../reference/choice_params.html">choice_params()</a></code>
function (for specifics, consult the <code>subopt_avian</code> R
documentation).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jpisklak/SiGN" class="external-link">SiGN</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Column Names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">subopt_avian</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "row"             "study"           "year"            "species"        </span></span>
<span><span class="co">#&gt;  [5] "exp"             "condition"       "n"               "cp"             </span></span>
<span><span class="co">#&gt;  [9] "il_dur_a"        "il_dur_b"        "tl_dur_a1"       "tl_dur_a2"      </span></span>
<span><span class="co">#&gt; [13] "tl_dur_b1"       "tl_dur_b2"       "tl_p_a1"         "tl_p_a2"        </span></span>
<span><span class="co">#&gt; [17] "tl_p_b1"         "tl_p_b2"         "tr_p_a1"         "tr_p_a2"        </span></span>
<span><span class="co">#&gt; [21] "tr_p_b1"         "tr_p_b2"         "il_sched_a"      "il_sched_b"     </span></span>
<span><span class="co">#&gt; [25] "tl_sched_a1"     "tl_sched_a2"     "tl_sched_b1"     "tl_sched_b2"    </span></span>
<span><span class="co">#&gt; [29] "forced_exposure" "DOI"             "ref"             "data_version"</span></span></code></pre></div>
<p>One key column is <code>$cp</code>, which reflects the observed
choice proportion reported by each study. These values can be directly
compared to predictions from the SiGN model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model Predictions</span></span>
<span><span class="co">#-------------------------------------------------------------------------------</span></span>
<span><span class="co"># Extract relevant parameter columns (cols 9–24 align with choice_params())</span></span>
<span><span class="va">data_cols</span> <span class="op">&lt;-</span> <span class="va">subopt_avian</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">24</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Construct model input list</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">choice_params</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">data_cols</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate model predictions</span></span>
<span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SiGN.html">SiGN</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">details</span></span></code></pre></div>
<p>Before plotting the comparisons, it will be helpful to first compute
some additional statistics to aid in model assessment:</p>
<ol style="list-style-type: decimal">
<li><p>An <span class="math inline">\(R^2\)</span> value to quantify the
proportion of variance in the observed data accounted for by the SiGN
model’s predictions.</p></li>
<li><p>The RMSE (root mean squared error) and MAE (mean absolute error),
which both reflect the average discrepancy between predicted and
observed values, with RMSE placing greater emphasis on larger
errors.</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model Assessment</span></span>
<span><span class="co">#-------------------------------------------------------------------------------</span></span>
<span><span class="co"># Fit a linear model comparing observed vs predicted</span></span>
<span><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">subopt_avian</span><span class="op">$</span><span class="va">cp</span> <span class="op">~</span> <span class="va">preds</span><span class="op">$</span><span class="va">cp</span><span class="op">)</span></span>
<span><span class="va">r_sq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span></span>
<span></span>
<span><span class="co"># Root Mean Squared Error (RMSE)</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">subopt_avian</span><span class="op">$</span><span class="va">cp</span> <span class="op">-</span> <span class="va">preds</span><span class="op">$</span><span class="va">cp</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Mean Absolute Error (MAE)</span></span>
<span><span class="va">mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">subopt_avian</span><span class="op">$</span><span class="va">cp</span> <span class="op">-</span> <span class="va">preds</span><span class="op">$</span><span class="va">cp</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The following plot illustrates the correspondence between observed
and predicted choice proportions. The dashed line represents perfect
prediction (y ~ x), while the solid line depicts the best-fitting linear
regression.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot of Results</span></span>
<span><span class="co">#-------------------------------------------------------------------------------</span></span>
<span><span class="co"># Format regression equation and annotations</span></span>
<span><span class="va">reg_eqn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>  <span class="st">"y = %.2f + %.2f x\n"</span>,</span>
<span>  <span class="va">reg</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">reg</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="va">r_sq_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"R² = %.2f"</span>, <span class="va">r_sq</span><span class="op">)</span></span>
<span><span class="va">rmse_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"RMSE = %.2f"</span>, <span class="va">rmse</span><span class="op">)</span></span>
<span><span class="va">mae_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"MAE = %.2f"</span>, <span class="va">mae</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">r_sq_text</span>, <span class="va">rmse_text</span>, <span class="va">mae_text</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">preds</span><span class="op">$</span><span class="va">cp</span>, <span class="va">subopt_avian</span><span class="op">$</span><span class="va">cp</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"n"</span>, las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Predicted"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Obtained"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reference line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">preds</span><span class="op">$</span><span class="va">cp</span>, <span class="va">subopt_avian</span><span class="op">$</span><span class="va">cp</span>, las <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Regression line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">reg</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, b <span class="op">=</span> <span class="va">reg</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">0.85</span>, labels <span class="op">=</span> <span class="va">reg_eqn</span>, cex <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">0.75</span>, labels <span class="op">=</span> <span class="va">stats</span>, cex <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<p><img src="suboptimal_data_files/figure-html/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The RMSE (0.14) and MAE (0.11) indicate that the model’s predictions
deviate from the observed values by approximately 11 to 14 percentage
points on average. This reflects a reasonably good fit to the
<code>subopt_avian</code> data set and aligns with expectations, given
the inherent variability across studies, species, and procedural
differences.</p>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Dunn, R. M., Pisklak, J. M., McDevitt, M. A., &amp; Spetch, M. L.
(2024). Suboptimal choice: A review and quantification of the signal for
good news (SiGN) model. <em>Psychological Review</em>. <em>131</em>(1),
58-78. <a href="https://doi.org/10.1037/rev0000416" class="external-link uri">https://doi.org/10.1037/rev0000416</a></p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeffrey Pisklak, Roger Dunn, Margaret McDevitt, Marcia Spetch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
