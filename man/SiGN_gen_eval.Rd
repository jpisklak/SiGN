% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SiGN_gen_eval.R
\name{SiGN_gen_eval}
\alias{SiGN_gen_eval}
\title{Fit a Generalised SiGN Model and Evaluate Fit Quality}
\usage{
SiGN_gen_eval(params, observed, b = 1, k_r = 1, k_d = 1, epsilon = 0.001, ...)
}
\arguments{
\item{params}{A list of parameter inputs compatible with the \code{SiGN()}
function, such as the output from \code{choice_params()}. Must be of the same
length as \code{observed}.}

\item{observed}{A numeric vector of observed choice proportions, one per condition.
Values must lie strictly between 0 and 1.}

\item{b}{Starting value for the bias parameter (default is 1).}

\item{k_r}{Starting value for the reinforcement rate sensitivity parameter
(default is 1).}

\item{k_d}{Starting value for the delay reduction sensitivity parameter
(default is 1).}

\item{epsilon}{A small positive value used to prevent undefined operations
(e.g., division by zero). Used when computing delay reductions or for
numerical stability in likelihood calculations.}

\item{...}{Additional arguments passed to internal functions.}
}
\value{
A list of class \code{"SiGN_gen_eval"} with the following components:
\describe{
\item{param_est}{A data frame of estimated model parameters (\code{b},
\code{k_r}, \code{k_d}).}
\item{desc_stats}{Descriptive statistics summarizing model fit (e.g.,
RMSE, R-squared, MAE, CCC).}
\item{info_criteria}{A data frame with the estimated \code{phi}, total
log-likelihood, AIC, and BIC.}
\item{mod_info}{The full model object returned by \code{nlsLM()}.}
\item{phi_optim_result}{The result from \code{optimize()} used to estimate
the beta model precision parameter.}
\item{residuals}{Vector of residuals (observed minus predicted choice
proportions).}
\item{details}{A data frame of all intermediate values, including
predictions and components of the SiGN model.}
}
}
\description{
This function fits a generalised version of the SiGN model to observed
choice proportions using non-linear least squares via \code{nlsLM()}, and
evaluates model fit using both descriptive and likelihood-based metrics.
A beta-distributed error model is used to estimate the log-likelihood and
compute AIC and BIC values. The model includes three free parameters:
bias (\code{b}), sensitivity to reinforcement rate (\code{k_r}), and
sensitivity to delay reduction (\code{k_d}).
}
\details{
The function assumes that each observed choice proportion is independent
and follows a beta distribution centred around the predicted value from the
generalised SiGN model. A single precision parameter (\code{phi}) is estimated
per model fit. AIC and BIC are based on four free parameters (three from the
model, one from the error distribution). Residual checks are recommended.
For additional details regarding the Beta error model, see \link{choice_mod_eval}.
}
\examples{
params <- do.call(choice_params, as.list(subopt_avian[9:24]))
result <- SiGN_gen_eval(params, subopt_avian$cp, b = 1, k_r = 1, k_d = 1)
print(result)
}
\seealso{
\code{\link[minpack.lm]{nlsLM}}, \link{choice_mod_eval}, \link{SiGN},
\link{choice_params}, \link{loglik_err}
}
