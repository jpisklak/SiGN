<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit a Generalised SiGN Model and Evaluate Fit Quality — SiGN_gen_eval • SiGN</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a Generalised SiGN Model and Evaluate Fit Quality — SiGN_gen_eval"><meta name="description" content="This function fits a generalised version of the SiGN model to observed
choice proportions using non-linear least squares via nlsLM(), and
evaluates model fit using both descriptive and likelihood-based metrics.
A beta-distributed error model is used to estimate the log-likelihood and
compute AIC and BIC values. The model includes three free parameters:
bias (b), sensitivity to reinforcement rate (k_r), and
sensitivity to delay reduction (k_d)."><meta property="og:description" content="This function fits a generalised version of the SiGN model to observed
choice proportions using non-linear least squares via nlsLM(), and
evaluates model fit using both descriptive and likelihood-based metrics.
A beta-distributed error model is used to estimate the log-likelihood and
compute AIC and BIC values. The model includes three free parameters:
bias (b), sensitivity to reinforcement rate (k_r), and
sensitivity to delay reduction (k_d)."><meta property="og:image" content="https://sign-r.github.io/SiGN/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SiGN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/SiGN.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/squires_fantino.html">Classic Concurrent-Chains</a></li>
    <li><a class="dropdown-item" href="../articles/batch-predict.html">Predictions From Data Frames</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model Evaluation</h6></li>
    <li><a class="dropdown-item" href="../articles/eval_descriptive.html">Descriptive Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/eval_info-theoretic.html">Information-Theoretic Statistics</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jpisklak.shinyapps.io/SiGN_Calc/">Online Calculator</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SiGN-R/SiGN/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Fit a Generalised SiGN Model and Evaluate Fit Quality</h1>
      <small class="dont-index">Source: <a href="https://github.com/SiGN-R/SiGN/blob/master/R/SiGN_gen_eval.R" class="external-link"><code>R/SiGN_gen_eval.R</code></a></small>
      <div class="d-none name"><code>SiGN_gen_eval.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits a generalised version of the SiGN model to observed
choice proportions using non-linear least squares via <code>nlsLM()</code>, and
evaluates model fit using both descriptive and likelihood-based metrics.
A beta-distributed error model is used to estimate the log-likelihood and
compute AIC and BIC values. The model includes three free parameters:
bias (<code>b</code>), sensitivity to reinforcement rate (<code>k_r</code>), and
sensitivity to delay reduction (<code>k_d</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SiGN_gen_eval</span><span class="op">(</span><span class="va">params</span>, <span class="va">observed</span>, b <span class="op">=</span> <span class="fl">1</span>, k_r <span class="op">=</span> <span class="fl">1</span>, k_d <span class="op">=</span> <span class="fl">1</span>, epsilon <span class="op">=</span> <span class="fl">0.001</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>A list of parameter inputs compatible with the <code><a href="SiGN.html">SiGN()</a></code>
function, such as the output from <code><a href="choice_params.html">choice_params()</a></code>. Must be of the same
length as <code>observed</code>.</p></dd>


<dt id="arg-observed">observed<a class="anchor" aria-label="anchor" href="#arg-observed"></a></dt>
<dd><p>A numeric vector of observed choice proportions, one per condition.
Values must lie strictly between 0 and 1.</p></dd>


<dt id="arg-b">b<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Starting value for the bias parameter (default is 1).</p></dd>


<dt id="arg-k-r">k_r<a class="anchor" aria-label="anchor" href="#arg-k-r"></a></dt>
<dd><p>Starting value for the reinforcement rate sensitivity parameter
(default is 1).</p></dd>


<dt id="arg-k-d">k_d<a class="anchor" aria-label="anchor" href="#arg-k-d"></a></dt>
<dd><p>Starting value for the delay reduction sensitivity parameter
(default is 1).</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>A small positive value used to prevent undefined operations
(e.g., division by zero). Used when computing delay reductions or for
numerical stability in likelihood calculations.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to internal functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>"SiGN_gen_eval"</code> with the following components:</p><dl><dt>param_est</dt>
<dd><p>A data frame of estimated model parameters (<code>b</code>,
<code>k_r</code>, <code>k_d</code>).</p></dd>

<dt>desc_stats</dt>
<dd><p>Descriptive statistics summarizing model fit (e.g.,
RMSE, R-squared, MAE, CCC).</p></dd>

<dt>info_criteria</dt>
<dd><p>A data frame with the estimated <code>phi</code>, total
log-likelihood, AIC, and BIC.</p></dd>

<dt>mod_info</dt>
<dd><p>The full model object returned by <code>nlsLM()</code>.</p></dd>

<dt>phi_optim_result</dt>
<dd><p>The result from <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">optimize()</a></code> used to estimate
the beta model precision parameter.</p></dd>

<dt>residuals</dt>
<dd><p>Vector of residuals (observed minus predicted choice
proportions).</p></dd>

<dt>details</dt>
<dd><p>A data frame of all intermediate values, including
predictions and components of the SiGN model.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function assumes that each observed choice proportion is independent
and follows a beta distribution centred around the predicted value from the
generalised SiGN model. A single precision parameter (<code>phi</code>) is estimated
per model fit. AIC and BIC are based on four free parameters (three from the
model, one from the error distribution). Residual checks are recommended.
For additional details regarding the Beta error model, see <a href="choice_mod_eval.html">choice_mod_eval</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/minpack.lm/man/nlsLM.html" class="external-link">nlsLM</a></code>, <a href="choice_mod_eval.html">choice_mod_eval</a>, <a href="SiGN.html">SiGN</a>,
<a href="choice_params.html">choice_params</a>, <a href="loglik_err.html">loglik_err</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">choice_params</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">subopt_avian</span><span class="op">[</span><span class="fl">9</span><span class="op">:</span><span class="fl">24</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">SiGN_gen_eval</span><span class="op">(</span><span class="va">params</span>, <span class="va">subopt_avian</span><span class="op">$</span><span class="va">cp</span>, b <span class="op">=</span> <span class="fl">1</span>, k_r <span class="op">=</span> <span class="fl">1</span>, k_d <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ℹ Default starting values (1, 1, 1) are being used. For better results, consider setting values that match the patterns in your data - poor starting points can trip up the fitting algorithm.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $param_est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          b       k_r       k_d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 1.030268 0.8627061 0.6784299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $desc_stats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n r_squared    mean_bias      rmse        mae  median_ae       ccc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 128 0.7968094 -0.007361284 0.1299345 0.09918741 0.07952289 0.9033226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $info_criteria</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n_parameters      phi   logLik       AIC       BIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            4 8.165909 10.48557 -12.97115 -1.563027</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeffrey Pisklak, Roger Dunn, Margaret McDevitt, Marcia Spetch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

